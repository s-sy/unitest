require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagestwo/chart/home"],{309:
/*!****************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/project/项目/unitest/main.js?{"page":"pagestwo%2Fchart%2Fhome"} ***!
  \****************************************************************************************************/
/*! no static exports found */function(e,t,i){"use strict";(function(e){i(/*! uni-pages */4);s(i(/*! vue */2));var t=s(i(/*! ./pagestwo/chart/home.vue */310));function s(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,i(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1)["createPage"])},310:
/*!*********************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/project/项目/unitest/pagestwo/chart/home.vue ***!
  \*********************************************************************************/
/*! no static exports found */function(e,t,i){"use strict";i.r(t);var s=i(/*! ./home.vue?vue&type=template&id=18f7318e& */311),n=i(/*! ./home.vue?vue&type=script&lang=js& */313);for(var a in n)"default"!==a&&function(e){i.d(t,e,(function(){return n[e]}))}(a);i(/*! ./home.vue?vue&type=style&index=0&lang=scss& */323);var o,g=i(/*! ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js */10),r=Object(g["default"])(n["default"],s["render"],s["staticRenderFns"],!1,null,null,null,!1,s["components"],o);r.options.__file="pagestwo/chart/home.vue",t["default"]=r.exports},311:
/*!****************************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/project/项目/unitest/pagestwo/chart/home.vue?vue&type=template&id=18f7318e& ***!
  \****************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(e,t,i){"use strict";i.r(t);var s=i(/*! -!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./home.vue?vue&type=template&id=18f7318e& */312);i.d(t,"render",(function(){return s["render"]})),i.d(t,"staticRenderFns",(function(){return s["staticRenderFns"]})),i.d(t,"recyclableRender",(function(){return s["recyclableRender"]})),i.d(t,"components",(function(){return s["components"]}))},312:
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/Administrator/Desktop/project/项目/unitest/pagestwo/chart/home.vue?vue&type=template&id=18f7318e& ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(e,t,i){"use strict";var s;i.r(t),i.d(t,"render",(function(){return n})),i.d(t,"staticRenderFns",(function(){return o})),i.d(t,"recyclableRender",(function(){return a})),i.d(t,"components",(function(){return s}));var n=function(){var e=this,t=e.$createElement;e._self._c},a=!1,o=[];n._withStripped=!0},313:
/*!**********************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/project/项目/unitest/pagestwo/chart/home.vue?vue&type=script&lang=js& ***!
  \**********************************************************************************************************/
/*! no static exports found */function(e,t,i){"use strict";i.r(t);var s=i(/*! -!./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./home.vue?vue&type=script&lang=js& */314),n=i.n(s);for(var a in s)"default"!==a&&function(e){i.d(t,e,(function(){return s[e]}))}(a);t["default"]=n.a},314:
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/Administrator/Desktop/project/项目/unitest/pagestwo/chart/home.vue?vue&type=script&lang=js& ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=o(i(/*! ./node_modules/@babel/runtime/regenerator */18)),n=o(i(/*! ../../pages/api/home.js */11)),a=o(i(/*! ../../utils/websocket/ws.js */315));function o(e){return e&&e.__esModule?e:{default:e}}function g(e,t,i,s,n,a,o){try{var g=e[a](o),r=g.value}catch(l){return void i(l)}g.done?t(r):Promise.resolve(r).then(s,n)}function r(e){return function(){var t=this,i=arguments;return new Promise((function(s,n){var a=e.apply(t,i);function o(e){g(a,s,n,o,r,"next",e)}function r(e){g(a,s,n,o,r,"throw",e)}o(void 0)}))}}var l={data:function(){return{distribution:getApp().globalData.distribution,wxUser:getApp().globalData.wxUser,currentPage:1,isOnce:!0,textMsg:"",isHistoryLoading:!1,scrollAnimation:!1,scrollTop:0,scrollToView:"",msgList:[],msgImgList:[],myuid:0,RECORDER:e.getRecorderManager(),isVoice:!1,voiceTis:"按住 说话",recordTis:"手指上滑 取消发送",recording:!1,willStop:!1,initPoint:{identifier:0,Y:0},recordTimer:null,recordLength:0,AUDIO:e.createInnerAudioContext(),playMsgid:null,VoiceTimer:null,popupLayerClass:"",hideMore:!0,hideEmoji:!0,emojiList:[[{url:"100.gif",alt:"[微笑]"},{url:"101.gif",alt:"[伤心]"},{url:"102.gif",alt:"[美女]"},{url:"103.gif",alt:"[发呆]"},{url:"104.gif",alt:"[墨镜]"},{url:"105.gif",alt:"[哭]"},{url:"106.gif",alt:"[羞]"},{url:"107.gif",alt:"[哑]"},{url:"108.gif",alt:"[睡]"},{url:"109.gif",alt:"[哭]"},{url:"110.gif",alt:"[囧]"},{url:"111.gif",alt:"[怒]"},{url:"112.gif",alt:"[调皮]"},{url:"113.gif",alt:"[笑]"},{url:"114.gif",alt:"[惊讶]"},{url:"115.gif",alt:"[难过]"},{url:"116.gif",alt:"[酷]"},{url:"117.gif",alt:"[汗]"},{url:"118.gif",alt:"[抓狂]"},{url:"119.gif",alt:"[吐]"},{url:"120.gif",alt:"[笑]"},{url:"121.gif",alt:"[快乐]"},{url:"122.gif",alt:"[奇]"},{url:"123.gif",alt:"[傲]"}],[{url:"124.gif",alt:"[饿]"},{url:"125.gif",alt:"[累]"},{url:"126.gif",alt:"[吓]"},{url:"127.gif",alt:"[汗]"},{url:"128.gif",alt:"[高兴]"},{url:"129.gif",alt:"[闲]"},{url:"130.gif",alt:"[努力]"},{url:"131.gif",alt:"[骂]"},{url:"132.gif",alt:"[疑问]"},{url:"133.gif",alt:"[秘密]"},{url:"134.gif",alt:"[乱]"},{url:"135.gif",alt:"[疯]"},{url:"136.gif",alt:"[哀]"},{url:"137.gif",alt:"[鬼]"},{url:"138.gif",alt:"[打击]"},{url:"139.gif",alt:"[bye]"},{url:"140.gif",alt:"[汗]"},{url:"141.gif",alt:"[抠]"},{url:"142.gif",alt:"[鼓掌]"},{url:"143.gif",alt:"[糟糕]"},{url:"144.gif",alt:"[恶搞]"},{url:"145.gif",alt:"[什么]"},{url:"146.gif",alt:"[什么]"},{url:"147.gif",alt:"[累]"}],[{url:"148.gif",alt:"[看]"},{url:"149.gif",alt:"[难过]"},{url:"150.gif",alt:"[难过]"},{url:"151.gif",alt:"[坏]"},{url:"152.gif",alt:"[亲]"},{url:"153.gif",alt:"[吓]"},{url:"154.gif",alt:"[可怜]"},{url:"155.gif",alt:"[刀]"},{url:"156.gif",alt:"[水果]"},{url:"157.gif",alt:"[酒]"},{url:"158.gif",alt:"[篮球]"},{url:"159.gif",alt:"[乒乓]"},{url:"160.gif",alt:"[咖啡]"},{url:"161.gif",alt:"[美食]"},{url:"162.gif",alt:"[动物]"},{url:"163.gif",alt:"[鲜花]"},{url:"164.gif",alt:"[枯]"},{url:"165.gif",alt:"[唇]"},{url:"166.gif",alt:"[爱]"},{url:"167.gif",alt:"[分手]"},{url:"168.gif",alt:"[生日]"},{url:"169.gif",alt:"[电]"},{url:"170.gif",alt:"[炸弹]"},{url:"171.gif",alt:"[刀子]"}],[{url:"172.gif",alt:"[足球]"},{url:"173.gif",alt:"[瓢虫]"},{url:"174.gif",alt:"[翔]"},{url:"175.gif",alt:"[月亮]"},{url:"176.gif",alt:"[太阳]"},{url:"177.gif",alt:"[礼物]"},{url:"178.gif",alt:"[抱抱]"},{url:"179.gif",alt:"[拇指]"},{url:"180.gif",alt:"[贬低]"},{url:"181.gif",alt:"[握手]"},{url:"182.gif",alt:"[剪刀手]"},{url:"183.gif",alt:"[抱拳]"},{url:"184.gif",alt:"[勾引]"},{url:"185.gif",alt:"[拳头]"},{url:"186.gif",alt:"[小拇指]"},{url:"187.gif",alt:"[拇指八]"},{url:"188.gif",alt:"[食指]"},{url:"189.gif",alt:"[ok]"},{url:"190.gif",alt:"[情侣]"},{url:"191.gif",alt:"[爱心]"},{url:"192.gif",alt:"[蹦哒]"},{url:"193.gif",alt:"[颤抖]"},{url:"194.gif",alt:"[怄气]"},{url:"195.gif",alt:"[跳舞]"}],[{url:"196.gif",alt:"[发呆]"},{url:"197.gif",alt:"[背着]"},{url:"198.gif",alt:"[伸手]"},{url:"199.gif",alt:"[耍帅]"},{url:"200.png",alt:"[微笑]"},{url:"201.png",alt:"[生病]"},{url:"202.png",alt:"[哭泣]"},{url:"203.png",alt:"[吐舌]"},{url:"204.png",alt:"[迷糊]"},{url:"205.png",alt:"[瞪眼]"},{url:"206.png",alt:"[恐怖]"},{url:"207.png",alt:"[忧愁]"},{url:"208.png",alt:"[眨眉]"},{url:"209.png",alt:"[闭眼]"},{url:"210.png",alt:"[鄙视]"},{url:"211.png",alt:"[阴暗]"},{url:"212.png",alt:"[小鬼]"},{url:"213.png",alt:"[礼物]"},{url:"214.png",alt:"[拜佛]"},{url:"215.png",alt:"[力量]"},{url:"216.png",alt:"[金钱]"},{url:"217.png",alt:"[蛋糕]"},{url:"218.png",alt:"[彩带]"},{url:"219.png",alt:"[礼物]"}]],onlineEmoji:{"100.gif":"AbNQgA.gif","101.gif":"AbN3ut.gif","102.gif":"AbNM3d.gif","103.gif":"AbN8DP.gif","104.gif":"AbNljI.gif","105.gif":"AbNtUS.gif","106.gif":"AbNGHf.gif","107.gif":"AbNYE8.gif","108.gif":"AbNaCQ.gif","109.gif":"AbNN4g.gif","110.gif":"AbN0vn.gif","111.gif":"AbNd3j.gif","112.gif":"AbNsbV.gif","113.gif":"AbNwgs.gif","114.gif":"AbNrD0.gif","115.gif":"AbNDuq.gif","116.gif":"AbNg5F.gif","117.gif":"AbN6ET.gif","118.gif":"AbNcUU.gif","119.gif":"AbNRC4.gif","120.gif":"AbNhvR.gif","121.gif":"AbNf29.gif","122.gif":"AbNW8J.gif","123.gif":"AbNob6.gif","124.gif":"AbN5K1.gif","125.gif":"AbNHUO.gif","126.gif":"AbNIDx.gif","127.gif":"AbN7VK.gif","128.gif":"AbNb5D.gif","129.gif":"AbNX2d.gif","130.gif":"AbNLPe.gif","131.gif":"AbNjxA.gif","132.gif":"AbNO8H.gif","133.gif":"AbNxKI.gif","134.gif":"AbNzrt.gif","135.gif":"AbU9Vf.gif","136.gif":"AbUSqP.gif","137.gif":"AbUCa8.gif","138.gif":"AbUkGQ.gif","139.gif":"AbUFPg.gif","140.gif":"AbUPIS.gif","141.gif":"AbUZMn.gif","142.gif":"AbUExs.gif","143.gif":"AbUA2j.gif","144.gif":"AbUMIU.gif","145.gif":"AbUerq.gif","146.gif":"AbUKaT.gif","147.gif":"AbUmq0.gif","148.gif":"AbUuZV.gif","149.gif":"AbUliF.gif","150.gif":"AbU1G4.gif","151.gif":"AbU8z9.gif","152.gif":"AbU3RJ.gif","153.gif":"AbUYs1.gif","154.gif":"AbUJMR.gif","155.gif":"AbUadK.gif","156.gif":"AbUtqx.gif","157.gif":"AbUUZ6.gif","158.gif":"AbUBJe.gif","159.gif":"AbUdIO.gif","160.gif":"AbU0iD.gif","161.gif":"AbUrzd.gif","162.gif":"AbUDRH.gif","163.gif":"AbUyQA.gif","164.gif":"AbUWo8.gif","165.gif":"AbU6sI.gif","166.gif":"AbU2eP.gif","167.gif":"AbUcLt.gif","168.gif":"AbU4Jg.gif","169.gif":"AbURdf.gif","170.gif":"AbUhFS.gif","171.gif":"AbU5WQ.gif","172.gif":"AbULwV.gif","173.gif":"AbUIzj.gif","174.gif":"AbUTQs.gif","175.gif":"AbU7yn.gif","176.gif":"AbUqe0.gif","177.gif":"AbUHLq.gif","178.gif":"AbUOoT.gif","179.gif":"AbUvYF.gif","180.gif":"AbUjFU.gif","181.gif":"AbaSSJ.gif","182.gif":"AbUxW4.gif","183.gif":"AbaCO1.gif","184.gif":"Abapl9.gif","185.gif":"Aba9yR.gif","186.gif":"AbaFw6.gif","187.gif":"Abaiex.gif","188.gif":"AbakTK.gif","189.gif":"AbaZfe.png","190.gif":"AbaEFO.gif","191.gif":"AbaVYD.gif","192.gif":"AbamSH.gif","193.gif":"AbaKOI.gif","194.gif":"Abanld.gif","195.gif":"Abau6A.gif","196.gif":"AbaQmt.gif","197.gif":"Abal0P.gif","198.gif":"AbatpQ.gif","199.gif":"Aba1Tf.gif","200.png":"Aba8k8.png","201.png":"AbaGtS.png","202.png":"AbaJfg.png","203.png":"AbaNlj.png","204.png":"Abawmq.png","205.png":"AbaU6s.png","206.png":"AbaaXn.png","207.png":"Aba000.png","208.png":"AbarkT.png","209.png":"AbastU.png","210.png":"AbaB7V.png","211.png":"Abafn1.png","212.png":"Abacp4.png","213.png":"AbayhF.png","214.png":"Abag1J.png","215.png":"Aba2c9.png","216.png":"AbaRXR.png","217.png":"Aba476.png","218.png":"Abah0x.png","219.png":"Abdg58.png"},windowsState:"",redenvelopeData:{rid:null,from:null,face:null,blessing:null,money:null}}},onUnload:function(){console.log("销毁"),this.unsubscribe(),this.disconnect()},onLoad:function(e){var t=this;t.userInfoGet()},onShow:function(){this.scrollTop=9999999},methods:{getuser:function(){var e=this;return new Promise((function(t,i){e.http(n.default.userInfoGet,"GET",{},!1).then((function(i){console.log("第一步，查看用户信息"),e.wxUser=i.data,getApp().globalData.wxUser=i.data,t(i.data)}))}))},choosedistruible:function(){var e=this,t=getApp().globalData.projectItem.id;return new Promise((function(i,s){e.http(n.default.GetShareInfno+"/distributions","GET",{affId:t},!1).then((function(e){console.log("第3步，随机置业"),console.log(e),i(e)}))}))},userInfoGet:function(){var e=this;return r(s.default.mark((function t(){var i,n,a;return s.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=e,console.log("进入聊天界面"),t.next=4,i.getuser();case 4:return n=t.sent,t.next=7,i.getdistribution();case 7:if(a=t.sent,console.log(a),null!=a){t.next=20;break}return console.log("置业为null"),t.next=13,i.choosedistruible();case 13:return t.sent,t.next=16,i.getuser();case 16:return n=t.sent,t.next=19,i.getdistribution();case 19:a=t.sent;case 20:console.log("置业不为null"),console.log(getApp().globalData.distribution),i.wxUser=n,getApp().globalData.wxUser=n,n.phone&&(getApp().globalData.websene=!1,i.getMsgList(),i.AUDIO.onEnded((function(e){i.playMsgid=null})),i.RECORDER.onStart((function(e){i.recordBegin(e)})),i.RECORDER.onStop((function(e){i.recordEnd(e)})),i.connect(),i.subscribe());case 25:case"end":return t.stop()}}),t)})))()},screenMsg:function(t){var i=JSON.parse(JSON.stringify(t));if(console.log("==========================="),console.log(i),"3"==i.type)switch(i.type){case"3":this.addSystemTextMsg(i);break;case"redEnvelope":this.addSystemRedEnvelopeMsg(i);break}else if("0"==i.type||"1"==i.type||"2"==i.type){switch(i.type){case"0":this.addTextMsg(i);break;case"2":this.addVoiceMsg(i);break;case"1":this.addImgMsg(i);break;case"redEnvelope":this.addRedEnvelopeMsg(i);break}console.log("用户消息"),i.senderId!=this.wxUser.id&&(console.log("振动"),e.vibrateLong())}this.$nextTick((function(){this.scrollToView="msg"+i.id}))},loadHistory:function(e){if(!this.isHistoryLoading){this.isHistoryLoading=!0,this.scrollAnimation=!1;var t=this.msgList[0].id;this.PostPage(this.currentPage),this.$nextTick((function(){this.scrollToView="msg"+t,this.$nextTick((function(){this.scrollAnimation=!0}))})),this.isHistoryLoading=!1}},getdistribution:function(){var e=this,t=getApp().globalData.projectItem.id,i=getApp().globalData.wxUser.distribution;return console.log("wxUser"),console.log(getApp().globalData.wxUser),new Promise((function(s,a){e.http(n.default.getall,"GET",{affId:t},!1).then((function(e){console.log("查看置业列表"),console.log(e);for(var t=e.data,n=null,a=0;a<t.length;a++)for(var o=0;o<i.length;o++)t[a].id==i[o]&&(n=t[a],getApp().globalData.distribution=t[a]);console.log("第二步，获取置业"),console.log(getApp().globalData.distribution),s(n)}))}))},getMsgList:function(){var e=this;return r(s.default.mark((function t(){return s.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e,e.PostPages(1),e.$nextTick((function(){this.scrollTop=9999,this.$nextTick((function(){this.scrollAnimation=!0}))}));case 3:case"end":return t.stop()}}),t)})))()},setPicSize:function(t){var i=e.upx2px(350),s=e.upx2px(350);if(t.w>i||t.h>s){var n=t.w/t.h;t.w=n>1?i:s*n,t.h=n>1?i/n:s}return t},showMore:function(){this.isVoice=!1,this.hideEmoji=!0,this.hideMore?(this.hideMore=!1,this.openDrawer()):this.hideDrawer()},openDrawer:function(){this.popupLayerClass="showLayer"},hideDrawer:function(){var e=this;this.popupLayerClass="",setTimeout((function(){e.hideMore=!0,e.hideEmoji=!0}),150)},chooseImage:function(){this.getImage("album")},camera:function(){this.getImage("camera")},handRedEnvelopes:function(){e.navigateTo({url:"HM-hand/HM-hand"}),this.hideDrawer()},getImage:function(t){var i=this;this.hideDrawer(),e.chooseImage({sourceType:[t],sizeType:["original","compressed"],success:function(t){console.log(t);for(var s=function(s){e.getImageInfo({src:t.tempFilePaths[s],success:function(e){console.log(e.width),console.log(e.height);var n=t.tempFilePaths[s];i.upload(n)}})},n=0;n<t.tempFilePaths.length;n++)s(n)}})},upload:function(t){console.log(t);var i=this;e.uploadFile({url:n.default.UpLoad,files:t,filePath:t,name:"file",fileType:"image",header:{"app-id":wx.getAccountInfoSync().miniProgram.appId,"third-session":getApp().globalData.thirdSession},formData:{dir:"material",fileType:"image"},success:function(e){console.log("上传图片结果"),console.log(e),console.log(JSON.parse(e.data).link);var t=getApp().globalData.wxUser,s={message:JSON.parse(e.data).link,type:"1",senderId:t.id,receiverId:"",userAvatar:t.headimgUrl,userName:t.nickName,createTime:new Date,status:"0"};i.sendMsg("",s,"1")}})},chooseEmoji:function(){this.hideMore=!0,this.hideEmoji?(this.hideEmoji=!1,this.openDrawer()):this.hideDrawer()},addEmoji:function(e){this.textMsg+=e.alt;console.log(e);var t=this.replaceEmoji(e.alt);console.log(t)},textareaFocus:function(){"showLayer"==this.popupLayerClass&&0==this.hideMore&&this.hideDrawer()},sendText:function(){if(this.hideDrawer(),this.textMsg){var e=this.replaceEmoji(this.textMsg),t=e;console.log(t),this.sendMsg(t,null,"0"),this.textMsg=""}},replaceEmoji:function(e){var t=this;console.log(e);var i=e.replace(/\[([^(\]|\[)]*)\]/g,(function(e,i){console.log("item: "+e);for(var s=0;s<t.emojiList.length;s++)for(var n=t.emojiList[s],a=0;a<n.length;a++){var o=n[a];if(o.alt==e){console.log(o.url);var g="https://img.0728jh.com/Emoji/",r='<img src="'+g+o.url+'" />';return console.log("imgstr: "+r),r}}}));return i},sendMsg:function(e,t,i){var n=this;return r(s.default.mark((function a(){var o,g,r,l,f,u,c;return s.default.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return console.log("查看发送消息"),console.log(e),o=n,null==t?(r=e,l=i,f=new Date,console.log(n.msgList),u=1,console.log(f.getTime()+""),console.log(u),g="2"==l?{id:f.getTime()+"",message:r.url,length:r.length,type:l,senderId:o.wxUser.id,receiverId:"",userAvatar:o.wxUser.headimgUrl,userName:o.wxUser.nickName,createTime:f.getHours()+":"+f.getMinutes(),status:"0"}:{id:f.getTime()+"",message:r,length:r.length,type:l,senderId:o.wxUser.id,receiverId:"",userAvatar:o.wxUser.headimgUrl,userName:o.wxUser.nickName,createTime:f.getHours()+":"+f.getMinutes(),status:"0"}):g=t,s.next=6,o.PostSend(g);case 6:c=s.sent,g["recordId"]=c,o.screenMsg(g),o.send(g);case 10:case"end":return s.stop()}}),a)})))()},addTextMsg:function(e){this.msgList.push(e),console.log(this.msgList)},addVoiceMsg:function(e){this.msgList.push(e),console.log(this.msgList)},addImgMsg:function(e){this.msgImgList.push(e.message),this.msgList.push(e),console.log(this.msgList)},addRedEnvelopeMsg:function(e){this.msgList.push(e)},addSystemTextMsg:function(e){this.msgList.push(e)},addSystemRedEnvelopeMsg:function(e){this.msgList.push(e)},PostSend:function(e){var t=this,i=getApp().globalData.projectItem,s=getApp().globalData.wxUser,a=new Date,o=getApp().globalData.distribution.id,g={};return"2"==e.type?(console.log("写库语音"),console.log(e),g={affiliationId:i.id,tenantId:i.tenantId,senderId:s.id,userId:s.id,salesmanId:o,createTime:a.getFullYear()+" "+a.getHours()+":"+a.getMinutes(),messageblob:e.message,type:e.type,speech:parseInt(e.speech.split(":")[1])||0}):g={affiliationId:i.id,tenantId:i.tenantId,senderId:s.id,userId:s.id,salesmanId:o,createTime:a.getFullYear()+" "+a.getHours()+":"+a.getMinutes(),messageblob:e.message,type:e.type},console.log("写库参数"),console.log(g),new Promise((function(e,i){t.http(n.default.ChattingRecords+"/send","POST",g,!1).then((function(t){console.log("写库—————————————————————————返回———————————————"),console.log(t),t.ok&&e(t.data.succeed)}))}))},openRedEnvelope:function(t,i){var s=this,n=t.content.rid;e.showLoading({title:"加载中..."}),console.log("index: "+i),setTimeout((function(){s.redenvelopeData=0==n?{rid:0,from:"大黑哥",face:"/static/img/im/face/face.jpg",blessing:"恭喜发财，大吉大利",money:"已领完"}:{rid:1,from:"售后客服008",face:"/static/img/im/face/face_2.jpg",blessing:"恭喜发财",money:"0.01"},e.hideLoading(),s.windowsState="show"}),200)},closeRedEnvelope:function(){var e=this;this.windowsState="hide",setTimeout((function(){e.windowsState=""}),200)},sendSystemMsg:function(e,t){var i=this.msgList[this.msgList.length-1].msg.id;i++;var s={type:"system",msg:{id:i,type:t,content:e}};this.screenMsg(s)},showPic:function(t){e.previewImage({indicator:"none",current:t.message,urls:this.msgImgList})},playVoice:function(e){this.playMsgid=e.id,console.log(e),this.AUDIO.src=e.message,console.log(e.message),this.$nextTick((function(){this.AUDIO.play()}))},voiceBegin:function(e){e.touches.length>1||(this.initPoint.Y=e.touches[0].clientY,this.initPoint.identifier=e.touches[0].identifier,this.RECORDER.start({format:"mp3"}))},recordBegin:function(e){var t=this;this.recording=!0,this.voiceTis="松开 结束",this.recordLength=0,this.recordTimer=setInterval((function(){t.recordLength++}),1e3)},voiceCancel:function(){this.recording=!1,this.voiceTis="按住 说话",this.recordTis="手指上滑 取消发送",this.willStop=!0,this.RECORDER.stop()},voiceIng:function(t){if(this.recording){var i=t.touches[0];this.initPoint.Y-i.clientY>=e.upx2px(100)?(this.willStop=!0,this.recordTis="松开手指 取消发送"):(this.willStop=!1,this.recordTis="手指上滑 取消发送")}},voiceEnd:function(e){this.recording&&(this.recording=!1,this.voiceTis="按住 说话",this.recordTis="手指上滑 取消发送",this.RECORDER.stop())},recordEnd:function(t){var i=this;if(clearInterval(i.recordTimer),i.willStop)console.log("取消发送录音");else{console.log("e: "+JSON.stringify(t));var s={length:0,url:t.tempFilePath},a=parseInt(i.recordLength/60),o=i.recordLength%60;a=a<10?"0"+a:a,o=o<10?"0"+o:o,s.length=a+":"+o,console.log("查看msg语音"),console.log(s),e.uploadFile({url:n.default.UpLoad,files:t.tempFilePath,filePath:t.tempFilePath,name:"file",fileType:"image",header:{"app-id":wx.getAccountInfoSync().miniProgram.appId,"third-session":getApp().globalData.thirdSession},formData:{dir:"material",fileType:"image"},success:function(e){console.log("上传图片结果"),console.log(e),console.log(JSON.parse(e.data).link);var t=getApp().globalData.wxUser,n=new Date,a={message:JSON.parse(e.data).link,type:"2",senderId:t.id,receiverId:"",userAvatar:t.headimgUrl,userName:t.nickName,createTime:n.getFullYear()+" "+n.getHours()+":"+n.getMinutes(),status:"0",speech:s["length"]};i.sendMsg(s,a,"2")}})}i.willStop=!1},switchVoice:function(){this.hideDrawer(),this.isVoice=!this.isVoice},discard:function(){},PostPages:function(e){console.log(e);var t=this,i=getApp().globalData.projectItem,s=getApp().globalData.wxUser,a=getApp().globalData.senen;t.http(n.default.ChattingRecords+"/page","POST",{currentPage:e,pageSize:20,affiliationId:i?i.id:a.affId,tenantId:i.tenantId,userId:s.id},!1).then((function(e){console.log("获取历史"),console.log(e);var i=Math.ceil(e.data.total/20);console.log("当前页，="+i),t.PostPage(i),t.PostReceived()}))},PostReceived:function(){var e=this,t=getApp().globalData.projectItem,i=getApp().globalData.distribution,s=getApp().globalData.wxUser;e.http(n.default.ChattingRecords+"/received","POST",{affiliationId:t.id,tenantId:t.tenantId,userId:s.id,salesmanId:i.id},!1).then((function(e){console.log("未读变已读"),console.log(e)}))},PostPage:function(e){var t=this;if(console.log(e),!(e<1)){var i=getApp().globalData.distribution;console.log("查看置业"),console.log(i);var s=getApp().globalData.projectItem,a=getApp().globalData.wxUser;t.http(n.default.ChattingRecords+"/page","POST",{currentPage:e,pageSize:20,affiliationId:s.id,tenantId:s.tenantId,userId:a.id},!1).then((function(s){console.log("获取历史聊天信息"),console.log(s),console.log("获取历史聊天信息");var n=s.data.chattingRecordsVOList,o=[];console.log(n);for(var g=0;g<n.length;g++){var r=n[g].id?n[g].id:100*e+g,l={id:r,message:n[g].messageblob,type:n[g].type,senderId:n[g].senderId,receiverId:n[g].receiverId,userAvatar:n[g].senderId==a.id?a.headimgUrl:i.headimgUrl,userName:n[g].senderId==a.id?a.nickName:i.realName,createTime:n[g].createTime,status:n[g].status};o.push(l)}t.msgList=o.concat(t.msgList),console.log(t.msgList),t.currentPage=e-1}))}},connect:function(){a.default.connect()},disconnect:function(e){a.default.disconnect()},subscribe:function(){a.default.subscribe("/topic/chat.typing",this.typing),a.default.subscribe("/topic/chat.message",this.message),a.default.subscribe("/user/exchange/amq.direct/chat.message",this.chatMessage),a.default.subscribe("/app/chat.participants",this.participants),a.default.subscribe("/topic/chat.login",this.login),a.default.subscribe("/topic/chat.logout",this.logout)},unsubscribe:function(){a.default.unsubscribe("/user/topic/message")},participants:function(e){var t=this;console.log("---获取在线列表--"),console.log(e);var i=JSON.parse(e.body);console.log(i),console.log("-----");var s="",n=new Date,a=getApp().globalData.projectItem,o=getApp().globalData.distribution;console.log("查看置业"),console.log(o),console.log("______________MsgList_________________"),console.log(t.msgList);for(var g=0;g<i.length;g++)if(console.log(i[g].username==o.id),i[g].username==o.id){s="对方在线，可以聊天了";var r=n.getTime().toString(),l={id:r,message:s,type:5,senderId:"",receiverId:"",userAvatar:"",userName:"系统消息",createTime:n.getFullYear()+" "+n.getHours()+":"+n.getMinutes(),status:"0"};t.msgList.push(l);var f=!0;console.log("----------------------------"),console.log(t.msgList);for(var u=t.msgList.length-1;u>=0;u--)"111222333444"==t.msgList[u]["id"]&&(f=!1);if(f){var c={id:"111222333444",message:"你好，我是"+a.projectName+"楼盘置业顾问"+o.realName+"("+o.phone+")，很高兴为您服务，有什么问题您可以随时咨询我。",type:0,senderId:o.id,receiverId:t.wxUser.id,userAvatar:o.headimgUrl,userName:o.realName,createTime:n.getFullYear()+" "+n.getHours()+":"+n.getMinutes(),status:"0"};t.msgList.push(c)}this.scrollToView="msg"+r}else if(t.isOnce){t.isOnce=!1,s="对方不在线，可以发送离线留言";var d=n.getTime().toString(),p={id:d,message:s,type:5,senderId:"",receiverId:"",userAvatar:"",userName:"系统消息",createTime:n.getFullYear()+" "+n.getHours()+":"+n.getMinutes(),status:"0"};t.msgList.push(p);for(var h=!0,m=t.msgList.length-1;m>=0;m--)"111222333444"==t.msgList[m]["id"]&&(h=!1);if(h){var b={id:"111222333444",message:"你好，我是"+a.projectName+"楼盘置业顾问"+o.realName+"("+o.phone+")，很高兴为您服务，有什么问题您可以随时咨询我。",type:0,senderId:o.id,receiverId:t.wxUser.id,userAvatar:o.headimgUrl,userName:o.realName,createTime:n.getFullYear()+" "+n.getHours()+":"+n.getMinutes(),status:"0"};t.msgList.push(b)}this.scrollToView="msg"+d}},typing:function(e){console.log("打字"),console.log(e)},login:function(e){console.log("登录"),console.log(e);var t=this,i="对方不在线，可以发送离线留言",s=new Date,n=JSON.parse(e.body),a=getApp().globalData.distribution;if(n.username==a.id){i="对方上线提醒";var o=s.getTime().toString(),g={id:o,message:i,type:5,senderId:"",receiverId:"",userAvatar:"",userName:"系统消息",createTime:s.getFullYear()+" "+s.getHours()+":"+s.getMinutes(),status:"0"};t.msgList.push(g),this.scrollToView="msg"+o}},logout:function(e){console.log("登出"),console.log(e);var t=this,i="",s=new Date,n=JSON.parse(e.body),a=getApp().globalData.distribution;if(n.username==a.id){i="对方离线提醒";var o=s.getTime().toString(),g={id:o,message:i,type:5,senderId:"",receiverId:"",userAvatar:"",userName:"系统消息",createTime:s.getFullYear()+" "+s.getHours()+":"+s.getMinutes(),status:"0"};t.msgList.push(g),this.scrollToView="msg"+o}},chatMessage:function(e){var t=this;console.log("dddddd"),console.log(e),console.log("--------------------------------------");var i=JSON.parse(e.body);console.log(i),console.log("--------------------------------------");var s=new Date,n={id:s.getTime().toString(),message:i.message,type:i.type,senderId:i.id,receiverId:t.wxUser.id,userAvatar:i.userAvatar,userName:i.userName,createTime:s.getFullYear()+" "+s.getHours()+":"+s.getMinutes(),status:"0"};t.msgList.push(n),this.scrollToView="msg"+s.getTime().toString()},message:function(e){console.log("小明"),console.log(e.body)},send:function(e){console.log("向服务端发送消息"),console.log(e);var t=getApp().globalData.distribution,i=getApp().globalData.wxUser;a.default.send("/app/chat.private/"+t.id,JSON.stringify({message:e.message,type:e.type,userAvatar:e.userAvatar,userName:e.userName,id:i.id,recordId:e.recordId}))}}};t.default=l}).call(this,i(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1)["default"])},323:
/*!*******************************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/project/项目/unitest/pagestwo/chart/home.vue?vue&type=style&index=0&lang=scss& ***!
  \*******************************************************************************************************************/
/*! no static exports found */function(e,t,i){"use strict";i.r(t);var s=i(/*! -!./node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-2!./node_modules/postcss-loader/src??ref--8-oneOf-1-3!./node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./home.vue?vue&type=style&index=0&lang=scss& */324),n=i.n(s);for(var a in s)"default"!==a&&function(e){i.d(t,e,(function(){return s[e]}))}(a);t["default"]=n.a},324:
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-2!./node_modules/postcss-loader/src??ref--8-oneOf-1-3!./node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/Administrator/Desktop/project/项目/unitest/pagestwo/chart/home.vue?vue&type=style&index=0&lang=scss& ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(e,t,i){}},[[309,"common/runtime","common/vendor","pagestwo/common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pagestwo/chart/home.js.map