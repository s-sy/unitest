require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagestwo/marketingCenter/home"],{325:
/*!**************************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/project/项目/unitest/main.js?{"page":"pagestwo%2FmarketingCenter%2Fhome"} ***!
  \**************************************************************************************************************/
/*! no static exports found */function(e,t,n){"use strict";(function(e){n(/*! uni-pages */4);o(n(/*! vue */2));var t=o(n(/*! ./pagestwo/marketingCenter/home.vue */326));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1)["createPage"])},326:
/*!*******************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/project/项目/unitest/pagestwo/marketingCenter/home.vue ***!
  \*******************************************************************************************/
/*! no static exports found */function(e,t,n){"use strict";n.r(t);var o=n(/*! ./home.vue?vue&type=template&id=10bd4748& */327),a=n(/*! ./home.vue?vue&type=script&lang=js& */329);for(var r in a)"default"!==r&&function(e){n.d(t,e,(function(){return a[e]}))}(r);n(/*! ./home.vue?vue&type=style&index=0&lang=css& */331);var s,i=n(/*! ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js */10),u=Object(i["default"])(a["default"],o["render"],o["staticRenderFns"],!1,null,null,null,!1,o["components"],s);u.options.__file="pagestwo/marketingCenter/home.vue",t["default"]=u.exports},327:
/*!**************************************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/project/项目/unitest/pagestwo/marketingCenter/home.vue?vue&type=template&id=10bd4748& ***!
  \**************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(e,t,n){"use strict";n.r(t);var o=n(/*! -!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./home.vue?vue&type=template&id=10bd4748& */328);n.d(t,"render",(function(){return o["render"]})),n.d(t,"staticRenderFns",(function(){return o["staticRenderFns"]})),n.d(t,"recyclableRender",(function(){return o["recyclableRender"]})),n.d(t,"components",(function(){return o["components"]}))},328:
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/Administrator/Desktop/project/项目/unitest/pagestwo/marketingCenter/home.vue?vue&type=template&id=10bd4748& ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(e,t,n){"use strict";var o;n.r(t),n.d(t,"render",(function(){return a})),n.d(t,"staticRenderFns",(function(){return s})),n.d(t,"recyclableRender",(function(){return r})),n.d(t,"components",(function(){return o}));var a=function(){var e=this,t=e.$createElement;e._self._c},r=!1,s=[];a._withStripped=!0},329:
/*!********************************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/project/项目/unitest/pagestwo/marketingCenter/home.vue?vue&type=script&lang=js& ***!
  \********************************************************************************************************************/
/*! no static exports found */function(e,t,n){"use strict";n.r(t);var o=n(/*! -!./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./home.vue?vue&type=script&lang=js& */330),a=n.n(o);for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);t["default"]=a.a},330:
/*!***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/Administrator/Desktop/project/项目/unitest/pagestwo/marketingCenter/home.vue?vue&type=script&lang=js& ***!
  \***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=s(n(/*! ./node_modules/@babel/runtime/regenerator */18)),a=s(n(/*! ../../utils/initPage.js */21)),r=s(n(/*! ../../pages/api/home.js */11));function s(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n,o,a,r,s){try{var i=e[r](s),u=i.value}catch(l){return void n(l)}i.done?t(u):Promise.resolve(u).then(o,a)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function s(e){i(r,o,a,s,u,"next",e)}function u(e){i(r,o,a,s,u,"throw",e)}s(void 0)}))}}var l=function(){n.e(/*! require.ensure | components/easy-select/easy-select */"components/easy-select/easy-select").then(function(){return resolve(n(/*! @/components/easy-select/easy-select.vue */568))}.bind(null,n)).catch(n.oe)},c={data:function(){return{list:[],wxUser:"",selecValue:"双皮奶",distribution:{},coustomerList:[],nowCoustomer:{},coustomerRealList:[],firstFigure:"",projectName:"",isCheck:!0,listone:[]}},components:{easySelect:l},onLoad:function(e){var t=this;console.log("+++++++++++++++++onLoad++++++++++++++++++++++++++++++"),a.default.initPage().then((function(e){var n=getApp().globalData.wxUser;t.getplatforminfo(),t.getUserinfozhiye(),2===n.userRole&&t.getTask()}))},methods:{commit:function(){var e=this;return u(o.default.mark((function t(){var n,a;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e,n.isCheck){t.next=4;break}return n.redirect(),t.abrupt("return");case 4:return t.next=6,n.chooseGW();case 6:if(a=t.sent,console.log("---------------------------------"),!a){t.next=14;break}return t.next=11,n.userInfoGet();case 11:return console.log("---------------------------------"),t.next=14,n.getProcessDefinition();case 14:case"end":return t.stop()}}),t)})))()},getUserProfile:function(e){var t=this;wx.getUserProfile({desc:"用于完善会员资料",success:function(e){t.http(r.default.wxUserSave,"POST",e,!1).then((function(e){t.userInfoGet()}))}})},getplatforminfo:function(){var e=this;e.http(r.default.platforminfo,"GET",{},!1).then((function(t){console.log("getplatforminfo-信息"),console.log(t);for(var n=t.data.basicInfoList,o=getApp().globalData.projectItem.id,a={},r=0;r<n.length;r++)n[r].id==o&&(a=n[r]);console.log(a),e.firstFigure=a.firstFigure,e.projectName=a.projectName}))},getPhoneNumber:function(e){var t=this;if("getPhoneNumber:ok"==e.detail.errMsg){var n=e.detail.encryptedData,o=e.detail.iv;a.default.initPage().then((function(e){var a=getApp().globalData.sessionKey;t.sendphoneNumber(n,a,o)}))}},sendphoneNumber:function(t,n,o){var a=this,s={encryptedData:"",session_key:"",iv:""};s.encryptedData=t,s.session_key=n,s.iv=o,e.request({url:r.default.GetPhone,method:"POST",data:s,timeout:12e4,header:{"app-id":wx.getAccountInfoSync().miniProgram.appId,"third-session":getApp().globalData.thirdSession},success:function(e){"request:ok"==e.errMsg&&(getApp().globalData.wxUser=e.data,a.wxUser=e.data,a.checkphonept())}})},getUserinfozhiye:function(){var e=this;return u(o.default.mark((function t(){var n,a,s,i,u,l,c,d;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e,a=getApp().globalData.projectItem.id,console.log(a),t.next=5,n.http(r.default.getall,"GET",{affId:a},!1);case 5:for(s=t.sent,i=s.data,console.log("ddddddddddddddddddd"),console.log(i),n.list=s.data,u=getApp().globalData.wxUser.distribution,n.wxUser=getApp().globalData.wxUser,l={},c=0;c<i.length;c++)for(d=0;d<u.length;d++)i[c].id==u[d]&&(getApp().globalData.distribution=i[c],l=i[c]);n.distribution=l,n.listone.push(l),n.wxUser.phone&&2!=n.wxUser.userRole&&n.checkphonept();case 17:case"end":return t.stop()}}),t)})))()},getProcessDefinition:function(){var t=this,n=getApp().globalData.projectItem.id;e.request({url:r.default.GetProcessDefinition,method:"GET",data:{tenantIdIn:n},success:function(n){if(console.log("平台流程"),console.log(n),200==n.statusCode){for(var o,a=n.data,r=0;r<a.length;r++)"passenger"==a[r].key&&(o=a[r].id);o?t.PostProcessAcquistion(o):e.showToast({title:"请检查key为passenger的流程是否存在",icon:"none",duration:3e3})}else e.showToast({title:"未找到有效流程，或流程未配置",icon:"none",duration:3e3})}})},checkphonept:function(){var t=this,n=getApp().globalData.projectItem;console.log("查看projctItem"),console.log(n),console.log(getApp().globalData.distribution);var o={phone:t.wxUser.phone,senderId:t.wxUser.id,affId:n.id,salesmanId:getApp().globalData.distribution?getApp().globalData.distribution.id:null,groupId:getApp().globalData.distribution?getApp().globalData.distribution.memberGroup:null,tenantId:t.wxUser.tenantId};return new Promise((function(n,a){e.request({method:"GET",url:r.default.Verificationplt,data:o,header:{"app-id":wx.getAccountInfoSync().miniProgram.appId,"third-session":getApp().globalData.thirdSession},success:function(o){console.log("验证电话pt"),console.log("_________________________________"),console.log(o),console.log("_________________________________"),o.data.ok?(t.isCheck=!0,n("true")):(t.isCheck=!1,e.showToast({title:"号码楼盘已存在",icon:"none",duration:2e3}),n("false"))}})}))},PostProcessAcquistion:function(t){var n=this,o=t,a=getApp().globalData.projectItem;e.request({url:r.default.GetProcessDefinition+"/"+o+"/submit-form",method:"POST",data:{variables:{initiator:{value:getApp().globalData.wxUser.id},phone:{value:n.wxUser.phone},customerName:{value:n.wxUser.realName?n.wxUser.realName:n.wxUser.nickName},affiliationId:{value:a.id},currentTaskDeposit:{value:!1},gender:{value:n.wxUser.sex,type:"String",valueInfo:{}},tenantId:{value:n.wxUser.tenantId},characters:{value:null},unspecified:{value:!getApp().globalData.distribution},salesmanId:{value:getApp().globalData.distribution?getApp().globalData.distribution.id:null},origin:{value:"1"}}},success:function(e){console.log("提交平台流程"),console.log(e),200==e.statusCode&&n.redirect()}})},userInfoGet:function(){var e=this;return u(o.default.mark((function t(){var n,a;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e,t.abrupt("return",new Promise((function(e,t){n.http(r.default.userInfoGet,"GET",{},!1).then((function(o){n.wxUser=o.data,getApp().globalData.wxUser=o.data,o.ok?e("success"):t("fail")}))})));case 4:a=t.sent,console.log("userInfoGet"),console.log(a),n.wxUser=a.data,getApp().globalData.wxUser=a.data;case 9:case"end":return t.stop()}}),t)})))()},chooseGW:function(){var t=this;return u(o.default.mark((function n(){var a,s,i;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=getApp().globalData.projectItem.id,s=t,i=s.distribution,n.abrupt("return",new Promise((function(t,n){s.http(r.default.GetShareInfno+"/distribution/"+i.id,"GET",{affId:a},!1).then((function(o){1!=o.data?(e.showToast({title:o.data,duration:2e3,icon:"none"}),n(!1)):t(!0)}))})));case 4:case"end":return n.stop()}}),n)})))()},getTask:function(){var t=this,n=getApp().globalData.wxUser;console.log(n.id),e.request({url:r.default.getTask,method:"GET",data:{assigneeIn:n.id},success:function(n){if(console.log("-------------------"),console.log(n),n.data){t.coustomerList=n.data;for(var o=[],a=0;a<n.data.length;a++)o.push(n.data[a]["processInstanceId"]);console.log("查看执行list id"),console.log(o),o.length>0?t.postReferrals(o):e.showToast({title:"无客户可操作",duration:1e3,icon:"none"})}}})},postReferrals:function(e){var t=this;t.http(r.default.Referrals+"/list","POST",e,!1).then((function(e){console.log("mycoustom"),console.log(e);for(var n=0;n<e.data.length;n++)e.data[n]["realName"]=e.data[n]["customerName"];t.coustomerRealList=e.data}))},commitprocessed:function(){for(var t=this,n=t.coustomerList,o=t.nowCoustomer,a="",s=0;s<n.length;s++)n[s].processInstanceId==o.instanceId&&(a=n[s].id);var i=t.distribution;if(""!=a){var u={variables:{agentId:{value:i.id.toString()}},withVariablesInReturn:!0};e.request({url:r.default.getTask+"/"+a+"/complete",method:"POST",data:u,success:function(n){console.log(n),200==n.statusCode&&(e.showToast({title:"处理成功",duration:1e3,icon:"none"}),setTimeout((function(){t.redirect()}),1e3))},fail:function(t){console.log(t),e.showToast({title:res.data.message,duration:2e3,icon:"none"})}})}else e.showToast({title:"未选择客户无法办理",duration:1e3,icon:"none"})},redirect:function(){console.log("跳转"),e.redirectTo({url:"/pages/index/index",success:function(e){},fail:function(){},complete:function(){}})},selectOne:function(e){console.log(e),this.distribution=e},selectTwo:function(e){console.log(e),this.nowCoustomer=e},useOutClickSide:function(){console.log(),this.$refs.easySelect.hideOptions&&this.$refs.easySelect.hideOptions()},useOutClickSides:function(){console.log(),this.$refs.easySelect1.hideOptions&&this.$refs.easySelect1.hideOptions()}}};t.default=c}).call(this,n(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1)["default"])},331:
/*!****************************************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/project/项目/unitest/pagestwo/marketingCenter/home.vue?vue&type=style&index=0&lang=css& ***!
  \****************************************************************************************************************************/
/*! no static exports found */function(e,t,n){"use strict";n.r(t);var o=n(/*! -!./node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--6-oneOf-1-2!./node_modules/postcss-loader/src??ref--6-oneOf-1-3!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./home.vue?vue&type=style&index=0&lang=css& */332),a=n.n(o);for(var r in o)"default"!==r&&function(e){n.d(t,e,(function(){return o[e]}))}(r);t["default"]=a.a},332:
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--6-oneOf-1-2!./node_modules/postcss-loader/src??ref--6-oneOf-1-3!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/Administrator/Desktop/project/项目/unitest/pagestwo/marketingCenter/home.vue?vue&type=style&index=0&lang=css& ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(e,t,n){}},[[325,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pagestwo/marketingCenter/home.js.map